(this.webpackJsonpbonds=this.webpackJsonpbonds||[]).push([[0],[,function(e,t,a){e.exports={table:"bonds-table_table__f76cV",cellText:"bonds-table_cellText__6Ni_f",cellNumber:"bonds-table_cellNumber__10V8f",cellGood:"bonds-table_cellGood__25rzV",cellOk:"bonds-table_cellOk__30Rkl",row:"bonds-table_row__2WZKd",headRow:"bonds-table_headRow___zbcg"}},function(e,t,a){e.exports={container:"filters_container__15Gc-",main:"filters_main__P0-WK",main_minimized:"filters_main_minimized__tDrVV",digest:"filters_digest__3yKhQ",digest_hidden:"filters_digest_hidden__U9oz1",minimizer:"filters_minimizer__xMcQu",minimizer_wrapper:"filters_minimizer_wrapper__34CDo",minimizer__arrow:"filters_minimizer__arrow__YGFIB",minimizer__arrow_up:"filters_minimizer__arrow_up__3aNTI",parameter:"filters_parameter__2w3by"}},,,,,,function(e,t,a){e.exports={title:"dashboard_title__1uPY5",main:"dashboard_main__3h5A-",disclaimer:"dashboard_disclaimer__279jz"}},,,,function(e,t,a){e.exports=a(19)},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(10),i=a.n(l),s=(a(17),a(18),a(3)),m=a(4),o=a(5),c=a.n(o);function u(e,t=2){return e.toLocaleString("ru-RU",{minimumFractionDigits:t,maximumFractionDigits:t})}var d=a(1),p=a.n(d);const h=e=>{const{list:t}=e;return r.a.createElement("table",{className:p.a.table},r.a.createElement("thead",null,r.a.createElement("tr",{className:p.a.headRow},["\u041e\u0431\u043b\u0438\u0433\u0430\u0446\u0438\u044f","\u0421\u0440\u043e\u043a","\u0426\u0435\u043d\u0430","\u041a\u0443\u043f\u043e\u043d","\u041f\u0435\u0440-\u0434","\u041e\u0441\u0442\u0430\u043b\u043e\u0441\u044c","\u041e\u0431\u044a\u0435\u043c","\u041d\u041a\u0414","\u0412\u044b\u043f\u043b\u0430\u0442\u044b\n\u043a \u043f\u043e\u0433\u0430\u0448\u0435\u043d\u0438\u044e","\u041e\u0431\u0449\u0438\u0439\n\u0434\u043e\u0445\u043e\u0434, \u0440","\u041d\u0430\u043b\u043e\u0433","\u041a\u043e\u043c\u0438\u0441\u0441\u0438\u044f, \u0440","\u0427\u0438\u0441\u0442\u044b\u0439\n\u0434\u043e\u0445\u043e\u0434, \u0440","\u0414\u043e\u0445\u043e\u0434\u043d\u043e\u0441\u0442\u044c,\n% \u0433\u043e\u0434\u043e\u0432\u044b\u0445","ISIN"].map((e,t)=>r.a.createElement("th",{key:t},e)))),r.a.createElement("tbody",null,t.map(E)))};function E(e){return r.a.createElement("tr",{className:p.a.row,key:e.isin},r.a.createElement("td",{className:p.a.cellText,title:e.name},e.shortName),r.a.createElement("td",{className:p.a.cellNumber,title:e.matureDate.toFormat("dd.MM.yyyy")},e.daysToMature),r.a.createElement("td",{className:p.a.cellNumber},u(e.price)),r.a.createElement("td",{className:p.a.cellNumber},u(e.couponValue)),r.a.createElement("td",{className:p.a.cellNumber},e.couponPeriod),r.a.createElement("td",{className:p.a.cellNumber},e.couponsToMature),r.a.createElement("td",{className:p.a.cellNumber,title:"\u0421\u043f\u0440\u0435\u0434 ".concat(e.spread)},r.a.createElement("span",{className:c()({[p.a.cellOk]:e.volume>5e6&&e.volume<1e7,[p.a.cellGood]:e.volume>1e7})},function(e){let t=e/1e6;return(t>=.1?u(t,1):"< 0,1")+" \u043c\u043b\u043d."}(e.volume))),r.a.createElement("td",{className:p.a.cellNumber},u(e.calculatedAccruedInterest)),r.a.createElement("td",{className:p.a.cellNumber},u(e.totalCashFlow)),r.a.createElement("td",{className:p.a.cellNumber},u(e.grossEarnings)),r.a.createElement("td",{className:p.a.cellNumber},u(e.couponTax)),r.a.createElement("td",{className:p.a.cellNumber},u(e.brokerFee+e.exchangeFee)),r.a.createElement("td",{className:p.a.cellNumber},u(e.netEarnings)),r.a.createElement("td",{className:p.a.cellNumber},e.netEarningsAnnualPercent,"\u2009%"),r.a.createElement("td",{className:p.a.cellText},r.a.createElement("a",{href:"https://www.rusbonds.ru/compare.asp?go=1&tool=".concat(e.isin),target:"_blank",rel:"noopener noreferrer"},e.isin)))}const _=((...e)=>e)("minVolume","name","minToMature","minNetEarnings","maxNetEarnings","maxToMature","onlyActive","onlyCheap"),f=e=>_.includes(e);const N=e=>Number(e)||0,b=a(7).identity,g={minVolume:N,maxToMature:N,minToMature:N,minNetEarnings:N,maxNetEarnings:N,name:e=>e.trim(),onlyActive:b,onlyCheap:b},v=e=>g[e];var y=a(11);const w=Object(y.sequenceT)(s.option);var T=a(2),x=a.n(T);const M=({filters:e,onFiltersChange:t})=>{const a=O(t),[l,i]=Object(n.useState)(!1),s=c()({[x.a.main]:!0,[x.a.main_minimized]:l}),m=c()({[x.a.digest]:!0,[x.a.digest_hidden]:!l}),o=c()({[x.a.minimizer__arrow]:!0,[x.a.minimizer__arrow_up]:l}),{minVolume:u,minToMature:d,maxToMature:p,minNetEarnings:h,maxNetEarnings:E,name:_}=e;return r.a.createElement("div",{className:x.a.container},r.a.createElement("div",{className:x.a.minimizer_wrapper},r.a.createElement("button",{className:x.a.minimizer,onClick:()=>i(!l)},r.a.createElement("span",{className:o},"\xbb"))),r.a.createElement("div",{className:m},u&&r.a.createElement("span",null,"\u043c\u0438\u043d. \u043e\u0431. ",u,", "),(d||p)&&r.a.createElement("span",null,"\u0441\u0440\u043e\u043a ",d,"\u2014",p||"\u221e",", "),(h||E)&&r.a.createElement("span",null,"\u0434\u043e\u0445. ",h,"\u2014",E||"\u221e",", "),_&&r.a.createElement("span",null,"\u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \xab",_,"\xbb")),r.a.createElement("div",{className:s},r.a.createElement("div",{className:x.a.parameter},r.a.createElement("label",{htmlFor:"minVolume"},"\u041e\u0431\u044a\u0435\u043c \u0437\u0430 \u0434\u0435\u043d\u044c, \u0442\u044b\u0441. \u0440\u0443\u0431."),r.a.createElement("input",{type:"number",id:"minVolume",name:"minVolume",defaultValue:u,onChange:a})),r.a.createElement("div",{className:x.a.parameter},r.a.createElement("label",{htmlFor:"minToMature"},"\u041f\u043e\u0433\u0430\u0448\u0435\u043d\u0438\u0435 \u0447\u0435\u0440\u0435\u0437"),r.a.createElement("input",{type:"number",id:"minToMature",name:"minToMature",defaultValue:d,onChange:a}),r.a.createElement("span",null," \u2014 "),r.a.createElement("input",{type:"number",id:"maxToMature",name:"maxToMature",defaultValue:p,onChange:a})),r.a.createElement("div",{className:x.a.parameter},r.a.createElement("label",{htmlFor:"minNetEarnings"},"\u0414\u043e\u0445\u043e\u0434\u043d\u043e\u0441\u0442\u044c"),r.a.createElement("input",{type:"number",id:"minNetEarnings",name:"minNetEarnings",defaultValue:h,onChange:a}),r.a.createElement("span",null," \u2014 "),r.a.createElement("input",{type:"number",id:"maxNetEarnings",name:"maxNetEarnings",defaultValue:E,onChange:a})),r.a.createElement("div",{className:x.a.parameter},r.a.createElement("label",{htmlFor:"maxToMature"},"\u041f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e (\u0447\u0435\u0440\u0435\u0437 \u0437\u0430\u043f\u044f\u0442\u0443\u044e)"),r.a.createElement("input",{type:"text",id:"name",name:"name",defaultValue:_,onChange:a}))))},O=e=>t=>{const a=Object(m.pipe)(Object(s.fromNullable)(t.target.getAttribute("name")),Object(s.filter)(f)),n=Object(s.fromNullable)(t.target.value),r=Object(m.pipe)(a,Object(s.map)(v)),l=Object(m.pipe)(w(a,n,r),Object(s.map)(([e,t,a])=>({[e]:a(t)})));e(l)};var C=a(8),V=a.n(C);class D extends r.a.Component{constructor(...e){super(...e),this.state={filters:{minVolume:1e4,minToMature:30,maxToMature:548,minNetEarnings:4,maxNetEarnings:20,name:"",onlyActive:!0,onlyCheap:!0}},this.handleFiltersChange=e=>{console.log(e),Object(m.pipe)(e,Object(s.fold)(()=>null,e=>{const t={...this.state.filters,...e};this.setState({filters:t})}))},this.sanitize=e=>e.quote>100&&e.couponPeriod>10&&e.accruedInterest>0,this.sortByMatureDate=(e,t)=>e.matureDate>t.matureDate?1:-1,this.filterOnlyCheap=e=>!this.state.filters.onlyCheap||e.couponValue<100,this.filterOnlyActive=e=>!this.state.filters.onlyActive||e.couponValue>1,this.filterByName=e=>{const{filters:{name:t}}=this.state,a=t.toLowerCase().split(",");let n=e.shortName.toLowerCase();return 0===t.length||!!a.find(e=>n.startsWith(e))},this.filterByVolume=e=>{const{filters:{minVolume:t}}=this.state;return!t||e.volume>=t},this.filterByToMature=e=>{const{filters:{minToMature:t,maxToMature:a}}=this.state,n=e.matureDate.diffNow("days").days;return n>=t&&(!a||n<=a)},this.filterByNetEarnings=e=>{const{filters:{minNetEarnings:t,maxNetEarnings:a}}=this.state,n=e.netEarningsAnnualPercent,r=n>=t&&(!a||n<=a);return console.log(n,t,a,r),r}}render(){const e=this.props.list.filter(this.sanitize).filter(this.filterOnlyActive).filter(this.filterByName).filter(this.filterOnlyCheap).filter(this.filterByVolume).filter(this.filterByToMature).filter(this.filterByNetEarnings).sort(this.sortByMatureDate);return r.a.createElement("div",null,r.a.createElement("h1",{className:V.a.title},"\u041e\u0431\u043b\u0438\u0433\u0430\u0446\u0438\u0438 \u043d\u0430 \u041c\u043e\u0441\u0431\u0438\u0440\u0436\u0435"),r.a.createElement("div",{className:V.a.main},r.a.createElement(M,{filters:this.state.filters,onFiltersChange:this.handleFiltersChange}),r.a.createElement("div",null),r.a.createElement(h,{list:e})),r.a.createElement("div",{className:V.a.disclaimer},r.a.createElement("p",null,"\u0420\u0430\u0441\u0447\u0451\u0442 \u043d\u0435 \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u0435\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u0443\u044e \u043e\u0444\u0435\u0440\u0442\u0443, \u0430\u043c\u043e\u0440\u0442\u0438\u0437\u0430\u0446\u0438\u044e \u0438 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0439 \u043a\u0443\u043f\u043e\u043d. \u0414\u043b\u044f \u043f\u0440\u0438\u043d\u044f\u0442\u0438\u044f \u0438\u043d\u0432\u0435\u0441\u0442\u0438\u0446\u0438\u043e\u043d\u043d\u043e\u0433\u043e \u0440\u0435\u0448\u0435\u043d\u0438\u044f \u0438\u0437\u0443\u0447\u0438\u0442\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e\u0431 \u043e\u0431\u043b\u0438\u0433\u0430\u0446\u0438\u0438. \u041f\u0440\u043e\u0449\u0435 \u0432\u0441\u0435\u0433\u043e \u043d\u0430\u0439\u0442\u0438 \u0435\u0451 \u043f\u043e ISIN \u043d\u0430 ",r.a.createElement("a",{href:"https://www.rusbonds.ru/compare.asp"},"\u0441\u0430\u0439\u0442\u0435 \u0418\u043d\u0442\u0435\u0440\u0444\u0430\u043a\u0441\u0430"),".")))}}const z=e=>{const{nominal:t,matureDate:a,couponValue:n,couponPeriod:r,quote:l}=e,i=t*l/100,s=i*(.07*.01),m=1e-4*i,o=0|a.diffNow("days").days,c=r-o%r-1,u=(c+1)*n/r,d=Math.floor(o/r)+1,p=d*n+t,h=p-u-i,E=.13*h,_=h-E-s-m,f=Math.round(h/i/o*365*1e4)/100;return{...e,price:i,brokerFee:s,exchangeFee:m,daysToMature:o,nextCouponDays:c,calculatedAccruedInterest:u,couponsToMature:d,totalCashFlow:p,grossEarnings:h,couponTax:E,netEarnings:_,netEarningsAnnualPercent:f}};var k=a(6);const F=["TQCB","EQOB"],j=async()=>{const e=F.map(e=>"https://iss.moex.com/iss/engines/stock/markets/bonds/boards/%BOARD%/securities.json".replace("%BOARD%",e)),t=await e.map(async e=>{const t=await fetch(e);return await t.json()}),a=await Promise.all(t),n=a.reduce((e,t)=>{var a;return e.concat(null===t||void 0===t||null===(a=t.securities)||void 0===a?void 0:a.data)},[]),r=a.reduce((e,t)=>{var a;return e.concat(null===t||void 0===t||null===(a=t.marketdata)||void 0===a?void 0:a.data)},[]),l=a.reduce((e,t)=>{var a;return e.concat(null===t||void 0===t||null===(a=t.marketdata_yields)||void 0===a?void 0:a.data)},[]);return n.map(e=>{const t=r.find(t=>e[0]===t[0]),a=l.find(t=>e[0]===t[0]);return function([e,t,a,n,r,l,i,s,m,o,c,u,d,p,h,E,_,f,N,b,g,v,y,w,T,x,M,O,C,V,D,z,F,j,B,A,I,P,S,R],G,W){return{shortName:a,name:g,matureDate:k.DateTime.fromISO(p),accruedInterest:s,couponPercent:I,couponPeriod:E,couponValue:l,nextCouponDate:k.DateTime.fromISO(i),isin:V,offerDate:k.DateTime.fromISO(P),settleDate:k.DateTime.fromISO(S),averagePrice:n,quote:W?W[2]:0,spread:G[5],volume:G[53],nominal:R}}(e,t,a)})};var B=function(){const[e,t]=Object(n.useState)([]);return Object(n.useEffect)(()=>{j().then(e=>t(e.map(z)))},[]),r.a.createElement("div",{className:"App"},r.a.createElement(D,{list:e}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(B,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()}).catch(e=>{console.error(e.message)})}],[[12,1,2]]]);
//# sourceMappingURL=main.5d0406d4.chunk.js.map